<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>ToDo List</h1>

    <!--入力エリア-->
    <div class="input-area">
        <!--入力を受ける窓-->
        <input type="text" id="text-input" placeholder="ToDoを入力してください">
        <button type="button" id="add-btn">追加</button>
    </div>

    <!-- フィルターボタン -->
    <div class="filter-area">
        <button class="filter-btn" data-filter="all">全体</button>
        <button class="filter-btn" data-filter="active">進行中</button>
        <button class="filter-btn" data-filter="completed">完了</button>
    </div>

    <!-- ToDo一覧 -->
    <ul id="todo-list">
        <li class="list-item completed">
            <input type="checkbox" name="" id="">
            <span class="todo-text"> やること</span>
            <button type="button" class="delete-button">delete</button>
        </li>
    </ul>

    <!-- 統計 -->
     <div class="stats" id="status"></div>


    <script>

        //　DOM受け取る
        const textInput = document.getElementById('text-input');
        const todoList  = document.getElementById('todo-list');
        const addBtn    = document.getElementById('add-btn');
        const filterArea = document.querySelector('.filter-area');
        let currentFilter = 'all'; // 今どのフィfilterルターか

        function todoAdd(){

            const text = textInput.value.trim();

            if (text === ''){
                return;
            } 
            
            // ToDo一つのli、span、buttonタグを作る 
            const li = document.createElement('li');
            li.classList.add('list-item');
             
            // 完了チェック（状態をもたせる）
            const checkbox = document.createElement('input');
            checkbox.type  = 'checkbox';
            checkbox.classList.add('todo-check');
            li.appendChild(checkbox);
            checkbox.addEventListener('change', () => {

                li.classList.toggle('completed');

            });
            
            // span
            const span = document.createElement('span');
            span.classList.add('todo-text');
            span.textContent = text;
            li.appendChild(span);

            // button
            const button = document.createElement('button');
            button.type = ('button');
            button.classList.add('delete-button');
            button.textContent = ('削除');
            li.appendChild(button);

            //　DOM表示する
            todoList.appendChild(li);

            // ToDo削除
            button.addEventListener('click', e => {
                todoList.removeChild(e.target.closest('li'));
            });

            // 入力欄を空にする
            textInput.value = '';
        };

        // 選ばれたフィルターを特定して、反映させる処理
        filterArea.addEventListener('click', function(e) {

            if(!e.target.classList.contains('filter-btn')) return;

            currentFilter = e.target.dataset.filter;
            applyFilter();
        });

        // 今選ばれているフィルターに合わせて、ToDo を「見せる or 隠す」関数
        function applyFilter() {
            
            // li(ToDo)を全部取得
            const items = todoList.querySelectorAll('.list-item');

            // ToDoを1つずつ見る
            items.forEach(li => {

                // そのToDoは終わってるか？
                const isCompleted = li.classList.contains('completed');
     
                // displayを切り替える
                if (currentFilter === 'all') {
                    li.style.display = "";
                } else if (currentFilter === 'active') {
                    li.style.display = isCompleted ? "none" : "";
                } else if (currentFilter === 'completed') {
                    li.style.display = isCompleted ? "" : "none";
                }
            });
        }

        //　追加ボタン押されたらイベント発生
        addBtn.addEventListener('click', todoAdd);
        
    </script>
</body>
</html>